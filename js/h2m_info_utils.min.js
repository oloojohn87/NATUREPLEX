function LoadDonuts(e){var a=e,t=0,i="GetSummaryData.php?User="+a;$.ajax({url:i,dataType:"json",async:!1,success:function(e){ConnData=e.items}}),t=ConnData[0].Data,PastDx=ConnData[1].Data,Medications=ConnData[2].Data,Allergies=ConnData[3].Data,Family=ConnData[4].Data,Habits=ConnData[5].Data;var r=document.getElementById("myCanvas"),n=r.getContext("2d"),l=r.width/2,o=r.height/2,s=75,d=0-Math.PI/2,c=!1,g=new Array,v=new Array,f=new Array,h=new Array,p=new Array,m=new Array,u=new Array;g[1]="#54bc00",h[1]=5,p[1]=10,v[1]=t>h[1]?p[1]:t*p[1]/h[1],f[1]="Admin",m[1]="Admin",u[1]="Data",g[2]="#f39c12",p[2]=10,v[2]=Allergies>0?10:0,f[2]="Immuno",m[2]="Immun",u[2]="Allergy",g[3]="#2c3e50",h[3]=5,p[3]=40,v[3]=PastDx>0?40:0,f[3]="History",m[3]="Perso",u[3]="History",g[4]="#18bc9c",v[4]=15,p[4]=15,v[4]=Medications>0?15:0,f[4]="Medication",m[4]="Drugs",u[4]="Meds",g[5]="#e74c3c",v[5]=15,p[5]=15,v[5]=Family>0?15:0,f[5]="Family",m[5]="Family",u[5]="History",g[6]="#3498db",v[6]=10,p[6]=10,v[6]=Habits>0?10:0,f[6]="Habits",m[6]="Habits",u[6]="Life";var b=new Array,y=0,x=0,A=1,M=(new Array,0),T=0,I=new Array,w=1,k=0,B=Array();for(d=0-Math.PI/2;7>w;)endAngle=d+TranslateAngle(v[w],100),midAngle=d+TranslateAngle(v[w]/2,100),B[w]=midAngle,halfsegment=v[w]/2,k+=v[w],50>k-halfsegment?(b[w]="Right",y++):(b[w]="Left",x++),d=endAngle,R=endAngle,w++;console.log("Right:"+y+"    Left:"+x);var P=0;n.lineWidth=35,d=0-Math.PI/2;for(var R=0,V=1,w=1,L=0;7>w;){P+=v[w],n.beginPath(),ColorRGB=hexToRgb(g[w]);var X=Math.random(),X=1;SegColor="rgba("+ColorRGB.r+","+ColorRGB.g+","+ColorRGB.b+","+X+")",n.beginPath(),n.strokeStyle=SegColor,n.lineCap="butt",endAngle=d+TranslateAngle(v[w],100),midAngle=d+TranslateAngle(v[w]/2,100),B[w]=midAngle,n.lineWidth=35,n.arc(l,o,s,d,endAngle,c),n.stroke();var _=l+s*Math.cos(midAngle)-12,H=o+s*Math.sin(midAngle)-12,G=l+(s+17.5)*Math.cos(midAngle),Y=o+(s+17.5)*Math.sin(midAngle),W=document.getElementById(f[w]);v[w]>4&&n.drawImage(W,_,H,25,25),A=y>=w?w:w-y,"Left"==b[w]?(L++,M=10,V=2*o/(x+1),I[w]=6-(w-x+1),I[w]=w,G=l+(s+17.5)*Math.cos(B[I[w]]),Y=o+(s+17.5)*Math.sin(B[I[w]]),T=2*o-V*L):(M=l-s/2+20,M=280,V=2*o/(y+1),T=V*A,I[w]=w,VerticalDiff=T-Y,console.log("Diff: "+VerticalDiff+"     YBox: "+T+"     bory:"+Y),Math.abs(VerticalDiff)>40&&(T-=VerticalDiff/2)),n.font="10px Arial",n.fillStyle="#b6b6b6",n.fillText(m[I[w]],M,T+8),n.fillText(u[I[w]],M,T+8+10),n.beginPath(),n.lineWidth=3,n.strokeStyle=g[I[w]],n.lineCap="round",n.moveTo(M+35,T),n.lineTo(M+35,T+20),n.stroke(),n.font="bold 12px Arial",n.fillStyle="grey",percentSeg=parseInt(100*(v[I[w]]/p[I[w]])),labelSeg=100==percentSeg?"OK":percentSeg+"%",n.fillText(labelSeg,M+40,T+3+10),n.beginPath(),n.strokeStyle="#cacaca",n.lineWidth=2,"Left"==b[w]?(X1=M+40+30,XMiddle=G-(G-X1)/2):(X1=M-5,XMiddle=X1-(X1-G)/2),Y1=T+3+10-5,YMiddle=Y+(Y1-Y)/2,YMiddle=Y,n.moveTo(X1,Y1),n.bezierCurveTo(XMiddle,YMiddle,XMiddle,YMiddle,G,Y),n.stroke(),n.lineCap="butt",d=endAngle,R=endAngle,w++}n.beginPath(),n.fillStyle="#22aeff",n.lineWidth=1,n.arc(l,o,s-20,-Math.PI/2,2*Math.PI,c),n.fill(),n.stroke(),n.lineWidth=35;var z="30pt Lucida Sans Unicode",j=P+" %";n.fillStyle="#22aeff",n.fillStyle="white",n.textAlign="left",n.textBaseline="top",n.font=z;var F=n.measureText(j).width,U=GetCanvasTextHeight(j,z);n.fillText(j,l-F/2,o-U),n.beginPath(),ColorRGB=hexToRgb("#C0C0C0");var X=.2;SegColor="rgba("+ColorRGB.r+","+ColorRGB.g+","+ColorRGB.b+","+X+")",n.strokeStyle=SegColor;var E=100-P;endAngle=d+TranslateAngle(E,100),midAngle=d+TranslateAngle(E/2,100),n.lineWidth=35,n.arc(l,o,s,d,endAngle,c),n.stroke(),n.beginPath(),d=0-Math.PI/2,endAngle=R,n.strokeStyle="#585858",n.lineWidth=2,n.arc(l,o,s+17,d,endAngle,c),n.stroke(),n.beginPath(),n.arc(l,o,s-17,d,endAngle,c),n.stroke(),n.beginPath();var _=l+(s-18)*Math.cos(d),H=o+(s-18)*Math.sin(d),N=l+(s+18)*Math.cos(d),O=o+(s+18)*Math.sin(d);n.moveTo(_,H),n.lineTo(N,O);var _=l+(s-18)*Math.cos(R),H=o+(s-18)*Math.sin(R),N=l+(s+18)*Math.cos(R),O=o+(s+18)*Math.sin(R);n.moveTo(_,H),n.lineTo(N,O),n.stroke();var K=Array(),i="GetReportSet.php";$.ajax({url:i,dataType:"json",async:!1,success:function(e){K=e.items},error:function(e,a,t){alert(e.status),alert(t)}});var q=Array(),i="GetReportNumbers.php?User="+a;$.ajax({url:i,dataType:"json",async:!1,success:function(e){q=e.items},error:function(e,a,t){alert(e.status),alert(t)}});var r=document.getElementById("myCanvas2"),n=r.getContext("2d"),l=r.width/2,o=r.height/2,s=85,J=15,d=0-Math.PI/2,c=!1;g.length=0,v.length=0,f.length=0;for(var Q=1,Z=0;10>Q;)g[Q]=K[Q-1].color,v[Q]=q[Q-1].number,m[Q]=K[Q-1].title.substring(0,4),u[Q]=K[Q-1].abrev,Z+=parseInt(v[Q]),Q++;f[1]="R1",f[2]="R2",f[3]="R3",f[4]="R4",f[5]="R5",f[6]="R6",f[7]="R7",f[8]="R8",f[9]="R9",f[10]="R10";var ea=10,aa=Z;n.lineWidth=J,d=0-Math.PI/2;for(var b=new Array,y=0,x=0,A=1,M=(new Array,0),T=0,I=new Array,w=1,ta=0,k=0,B=Array();ea>=w;)v[w]>0&&(endAngle=d+TranslateAngle(v[w],100),midAngle=d+TranslateAngle(v[w]/2,100),B[w]=midAngle,k=parseInt(k+parseInt(v[w])),MidPoint=k-parseInt(v[w])/2,Z/2>=MidPoint?(b[w]="Right",y++):(b[w]="Left",x++),d=endAngle,R=endAngle,ta++),w++;var w=1;for(d=0-Math.PI/2;ea>=w;){if(n.beginPath(),SegColor=g[w],ta=0,v[w]>0){ta++,n.strokeStyle=SegColor,endAngle=d+TranslateAngle(v[w],aa),midAngle=d+TranslateAngle(v[w]/2,aa),n.lineWidth=J,n.arc(l,o,s,d,endAngle,c),n.stroke();var ia=30,ra=s-J/2-ia/2,_=l+ra*Math.cos(midAngle)-ia/2,H=o+ra*Math.sin(midAngle)-ia/2,W=document.getElementById(f[w]);n.drawImage(W,_,H,ia,ia);var G=l+(s+J/2)*Math.cos(midAngle),Y=o+(s+J/2)*Math.sin(midAngle);A=y>=ta?ta:ta-y,"Left"==b[w]?(M=10,V=2*o/(x+1),I[w]=6-(w-x+1),0==I[w]&&(I[w]=1),I[w]=w,T=V*A,VerticalDiff=T-Y,Math.abs(VerticalDiff)>2&&(T-=VerticalDiff/2)):(M=l-s/2+20,M=280,V=2*o/(y+1),T=V*A,I[w]=w,VerticalDiff=T-Y,Math.abs(VerticalDiff)>2&&(T-=VerticalDiff/2)),n.font="10px Arial",n.fillStyle="#b6b6b6",n.fillText(m[I[w]],M,T+8),n.fillText(u[I[w]],M,T+8+10),n.beginPath(),n.lineWidth=3,n.strokeStyle=g[I[w]],n.lineCap="round",n.moveTo(M+35,T),n.lineTo(M+35,T+20),n.stroke(),n.font="bold 14px Arial",n.fillStyle="grey",percentSeg=v[I[w]],labelSeg=100==percentSeg?"OK":percentSeg+"",n.fillText(labelSeg,M+40,T+5+10),n.beginPath(),n.strokeStyle="#cacaca",n.lineWidth=2,"Left"==b[w]?(X1=M+40+30,XMiddle=G-(G-X1)/2):(X1=M-5,XMiddle=X1-(X1-G)/2),Y1=T+3+10-5,YMiddle=Y+(Y1-Y)/2,YMiddle=Y,n.moveTo(X1,Y1),n.bezierCurveTo(XMiddle,YMiddle,XMiddle,YMiddle,G,Y),n.stroke(),n.lineCap="butt",d=endAngle}w++}n.beginPath(),n.fillStyle="#54bc00",n.lineWidth=1,n.arc(l,o,s-50,-Math.PI/2,2*Math.PI,c),n.fill(),n.strokeStyle="grey",n.stroke(),n.lineWidth=35;var z="28pt Arial",j=aa+"";n.fillStyle="#54bc00",n.fillStyle="white",n.textAlign="left",n.textBaseline="top",n.font=z;var F=n.measureText(j).width,U=GetCanvasTextHeight(j,z);n.fillText(j,l-F/2,o-(U-7))}function TranslateAngle(e,a){var t=e*Math.PI*2/a;return parseFloat(t)}function hexToRgb(e){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function GetICD10Code(e){{var a="https://api.aqua.io/codes/beta/icd10.json?utf8=%E2%9C%93&q%5Bdescription_cont%5D="+e,t="";Array()}return $.ajax({dataType:"json",url:a,async:!1,success:function(e){t=e;e[0]},error:function(e,a){alert(a)}}),t}function LanzaAjax(e){var a="SIN MODIFICACIÓN";return $.ajax({url:e,dataType:"html",async:!1,complete:function(){},success:function(e){"string"==typeof e&&(a=e)}}),a}function GetCanvasTextHeight(e,a){var t=document.createElement("canvas"),i=100,r=100;t.setAttribute("height",i),t.setAttribute("width",r);var n=t.getContext("2d");n.fillRect(0,0,r,i),n.textBaseline="top",n.fillStyle="white",n.font=a,n.fillText(e,0,0);for(var l=n.getImageData(0,0,r,i).data,o=-1,s=-1,d=0;i>d;d++)for(var c=0;r>c;c++){var g=4*(d*r+c);{if(0!=l[g]){-1==o&&(o=d);break}if(c==r-1&&-1!=o){s=d,d=i;break}}}return s-o}var Canvas1State=0;$("#PHSLabel").live("click",function(){if(0==Canvas1State){$("#PHSLabel").html("See Graph");for(var e="",a=Date.parse(ConnData[0].latest_update),t="",i="",r="",n=0;5>n;)thisDate=Date.parse(ConnData[n].latest_update),thisDate>=a&&(a=thisDate,t=ConnData[n].latest_update),n++;var l="",o="",s="",d="",c="";"th"==language?(l="Última actualización en",o="dias",s="semana",d="meses",c="años"):"en"==language&&(l="Latest update on",o="days",s="weeks",d="months",c="years"),r=l+" "+t.substr(0,10);var g=new Date,v=g-a,f=parseInt(v/864e5),h=parseInt(v/6048e5),p=parseInt(v/2592e6),m=parseInt(v/31536e6);14>f&&(i=f+" "+o),h>=2&&(i=h+" "+s),h>=8&&(i=p+" "+d),p>=13&&(i=m+" "+c);var u=h;if(u>1){var l="";"th"==language?l="Actualizar":"en"==language&&(l="Update"),contentTime="Summary is "+i+" old",iconTime='<button id="UpdateSumm" class="find_doctor_button" style="float:right; display: block; background-color: rgb(82, 216, 89); width:80px; margin-top:-3px;">'+l+"</button>"}else{var l="";"th"==language?l="Actualizado":"en"==language&&(l="Updated"),contentTime=l,iconTime='<i class="icon-check icon-2x" style="float:left;"></i>'}if(m>4){var l="",o="";"th"==language?(l="Actualizar",o="Resumen nunca actualizado"):"en"==language&&(l="Update",o="Summary never updated"),contentTime=o,iconTime='<i class="icon-exclamation icon-2x" style="float:left; color:rgb(216, 72, 64);"></i><button id="UpdateSumm" class="find_doctor_button" style="float:right; display: block; background-color: rgb(82, 216, 89); width:80px; margin-top:-3px;">'+l+"</button>"}for(var y=-1,a=Date.parse("1975-01-01 00:00:00"),x=a,A="",n=0;5>n;)thisVerified=ConnData[n].doctor_signed,thisDate=Date.parse(ConnData[n].latest_update),console.log(" K="+n+"   Doctor:"+n+"  Date:"+n),thisVerified>-1&&thisDate>=a&&(a=thisDate,y=ConnData[n].doctor_signed,x=ConnData[n].latest_update),n++;if(y>-1){var l="",o="",s="";"th"==language?(l="Verificar",tranlation2="Verificado por",s="en"):"en"==language&&(l="Verify",tranlation2="Verified by",s="on"),namedoctor=LanzaAjax("/getDoctorName.php?IdDoctor="+y),contentVerif=l;var D=(new Date).getTimezoneOffset(),S=moment(x).add("minutes",-1*D).fromNow();A=o+" "+namedoctor+" "+S,iconVerif='<i class="icon-check icon-2x"></i>'}else{var l="";"th"==language?(l="Verificar",contentVerif="No Verificado"):"en"==language&&(l="Verify",contentVerif="Not Verified"),iconVerif='<i class="icon-exclamation icon-2x" style="float:left; color:rgb(216, 72, 64);"></i><button id="VerifyDoctor" class="find_doctor_button" style="float:right; display: block; background-color: rgb(34, 174, 255); width:80px; margin-top:-3px;">'+l+"</button>"}for(var C=0,M=0,T='<i class="icon-check icon-2x"></i>',n=0;5>n;)C+=parseInt(ConnData[n].Data),ConnData[n].Data>0&&M++,n++;4>M&&(T='<i class="icon-exclamation icon-2x" style="float:left; color:rgb(216, 72, 64);"></i>');var l="";"th"==language?l="eventos registrados":"en"==language&&(l="events registered"),AdminData=ConnData[0].Data,PastDx=ConnData[1].Data,Medications=ConnData[2].Data,Immuno=ConnData[3].Data,Family=ConnData[4].Data,Habits=ConnData[5].Data,Allergies=ConnData[6].Data,e+="	               <style>",e+="	                div.SumBox{",e+="	                    float:left; ",e+="	                    position: absolute; ",e+="	                    z-index: 10; ",e+="	                    box-shadow: inset 0px 0px 2px 0px whitesmoke;",e+="	                }",e+="	                div.SumBox:hover {         ",e+="	                    opacity: 0.8;                ",e+="	                }                                ",e+="	                ",e+="	                img.SumBoxIcon{",e+="	                    position:absolute;",e+="	                    width:30px;",e+="	                    height:30px;",e+="	                    top: 50%;",e+="	                    left: 50%;",e+="	                    transform: translate(-50%, -50%);",e+="	                    font-size: 20px;",e+="	                    color: grey;",e+="	                    z-index:460;",e+="	                }",e+="	",e+="	                div.BannerIcon{     ",e+="	                    border: 1px solid #cacaca;       ",e+="	                    width: 15px;       ",e+="	                    height: 15px;      ",e+="	                    border-radius: 10px;       ",e+="	                    position: absolute;        ",e+="	                    left: 50%;       ",e+="	                    top: 50%;         ",e+="	                    z-index: 440;          ",e+="	                    margin-left: 8px;      ",e+="	                    margin-top: -18px;     ",e+="	                    color: #cacaca;     ",e+="	                    font-size: 12px;",e+="	                    text-align: center;     ",e+="	                    font-weight: bold;     ",e+="	                    line-height: 15px;     ",e+="	                }";var I=-1!=navigator.userAgent.indexOf("Mac");if(I)var w="top:50%;left:45%;",k="top:50%;left:45%;",B="top:43%;left:48%;",P="top:43%;left:43%;",R="top:45%;left:45%;",V="top:48%;left:45%;",L="top:45%;left:40%;";else var w="top:40%;left:35%;",k="top:40%;left:40%;",B="top:30%;left:35%;",P="top:30%;left:32%;",R="top:30%;left:27%;",V="top:25%;left:35%;",L="top:25%;left:25%;";e+="	                    ",e+="	                </style>  ",e+='	                <div style="background-color:white; z-index:999; position:absolute; left:0%; top:0%; width:100%; height:10px;"></div>  ',e+='	                <div style="background-color:white; z-index:999; position:absolute; left:320px; top:0%; width:50px; height:100%;"></div>  ',e+='	                <div id="SumGraph2" style="width: 275px; height: 165px; margin-top: 10px; margin-left: 45px; border:0px solid #cacaca; position:relative; cursor: pointer; border-radius:10px;">',e+="	                  ",e+='	                    <div class="SumBox" style="width:45%; height:45%; top:0%; left:0%; background-color:#54bc00; border-top-left-radius:10px;">',e+='	                       <img style="'+w+'" class="SumBoxIcon" src="images/icons/Adminx2_svg.png" />',AdminData>0&&(e+='	                       <div class="BannerIcon" >'+AdminData+"</div>"),e+="	                    </div>        ",e+='	                    <div class="SumBox" style="width:55%; height:45%; top:0%; left:45%; background-color:#2C3E50;  border-top-right-radius:10px;">',e+='	                        <img style="'+k+'" class="SumBoxIcon" src="images/icons/historyx2_svg.png" />',PastDx>0&&(e+='	                        <div class="BannerIcon" >'+PastDx+"</div>"),e+="	                    </div>     ",e+='	                    <div class="SumBox" style="width:30%; height:30%; top:45%; left:0%; background-color:#18BC9C;">',e+='	                        <img style="'+B+'" class="SumBoxIcon" src="images/icons/medicationx2_svg.png" />',Medications>0&&(e+='	                        <div class="BannerIcon" >'+Medications+"</div>"),e+="	                   </div>  ",e+='	                    <div class="SumBox" style="width:40%; height:30%; top:45%; left:30%; background-color:#E74C3C;">',e+='	                        <img style="'+P+'" class="SumBoxIcon" src="images/icons/familyx2_svg.png" />',Family>0&&(e+='	                        <div class="BannerIcon" >'+Family+"</div>"),e+="	                  </div>         ",e+='	                    <div class="SumBox" style="width:30%; height:55%; top:45%; left:70%; background-color:#3498DB;  border-bottom-right-radius:10px;">',e+='	                       <img style="'+R+'" class="SumBoxIcon" src="images/icons/habitsx2_svg.png" />',Habits>0&&(e+='	                        <div class="BannerIcon" >'+Habits+"</div>"),e+="	                   </div>            ",e+='	                    <div class="SumBox" style="width:50%; height:25%; top:75%; left:0%; background-color:#F39C12;  border-bottom-left-radius:10px;">',e+='	                        <img style="'+V+'" class="SumBoxIcon" src="images/icons/immunox2_svg.png" />',Immuno>0&&(e+='	                        <div class="BannerIcon" >'+Immuno+"</div>"),e+="	                  </div>    ",e+='	                    <div class="SumBox" style="width:20%; height:25%; top:75%; left:50%; background-color:#F39C12;">',e+='	                        <img style="'+L+'" class="SumBoxIcon" src="images/icons/allergyx2_svg.png" />',Allergies>0&&(e+='	                        <div class="BannerIcon" >'+Allergies+"</div>"),e+="	                   </div>      ",y>-1&&(e+='	                    <div class="ribbon-banner" id="ribbon-verified" href="#" style="display: block; width:220px; right:-63px; top:22px; background-color:#DB3469;"><span class="ribbon-lgtext">Verified</span><br> <span class="ribbon-smtext" style="font-size:8px;">'+A+'<span class="ribbon-lgtext"></span></span></div>'),e+="	",e+="	                  </div> ",$("#ALTCanvas1").html(e),$("#ALTCanvas1").animate({height:"200px"},1e3),$("#PHSLabel").css("background-color","rgb(82, 216, 89)"),Canvas1State=1}else $("#PHSLabel").html("See Status"),$("#PHSLabel").css("background-color","rgb(74, 134, 54)"),$("#ALTCanvas1").animate({height:"0px"},1e3),Canvas1State=0});