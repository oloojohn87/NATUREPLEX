function alarma(e,t){if(""==e){var i="0px";$(t).css("background-color","white")}else{var i="40px";$(t).css("background-color","#FFF8DC")}$(".MsgAlarma2").animate({height:i},500,function(){$(".MsgAlarma2").html('<p style="font-size:18px; color:white; margin:10px; top:10px; position:relative;">'+e+"</p>")})}function validateEmail(e){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return t.test(e)?!0:!1}function checkPhoneFormat(e,t,i,a){return 0==$("#Vphone").intlTelInput("isValidNumber")?a.allrules.validatePhone.alertText:void $("#Vphone").val($("#Vphone").val().replace(/\s+/g,""))}function inform_about_session(){$.ajax({url:"/ongoing_sessions.php?userid="+med_id,success:function(){}}),clearTimeout(sessionTimer),sessionTimer=setTimeout(inform_about_session,active_session_timer)}function ShowTimeOutWarning(){alert("Session expired");window.location="timeout.php"}function get_user_event_config(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){event_config=e.items}})}function getScript(e){$.ajax({url:e,dataType:"script",async:!1})}function displaynotification(e,t){getScript("realtime-notifications/lib/gritter/js/jquery.gritter.min.js");var i={title:e,text:t,image:"images/Icono_H2M.png",sticky:!1,time:"3000"};$.gritter.add(i)}function get_user_timezone(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){user_timezone=e.items}})}function get_timezones(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){timezones=e.items}})}function get_user_notify_time(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){notify_time=e.items}})}function get_emr_config(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){emr_config=e.items}})}function LanzaAjax(e){var t="SIN MODIFICACIÓN";return $.ajax({url:e,dataType:"html",async:!1,complete:function(){},success:function(e){"string"==typeof e&&(t=e)}}),t}function saveEMRConfig(){var o=get_checkbox_value("emr_address"),l=get_checkbox_value("emr_address2"),s=get_checkbox_value("emr_city"),c=get_checkbox_value("emr_state"),d=get_checkbox_value("emr_country"),p=get_checkbox_value("emr_notes"),m=get_checkbox_value("emr_phone"),u=get_checkbox_value("emr_insurance"),f=get_checkbox_value("emr_personal"),v=0,h=0,g=0,_=0,$=0;f&&(v=get_checkbox_value("emr_fractures"),h=get_checkbox_value("emr_surgeries"),g=get_checkbox_value("emr_otherknown"),_=get_checkbox_value("emr_obstetric"),$=get_checkbox_value("emr_othermed"));var b=get_checkbox_value("emr_family"),y=0,I=0,C=0;b&&(y=get_checkbox_value("emr_father"),I=get_checkbox_value("emr_mother"),C=get_checkbox_value("emr_siblings"));var x=get_checkbox_value("emr_pastdx"),D=get_checkbox_value("emr_medications"),w=get_checkbox_value("emr_immunizations"),k=get_checkbox_value("emr_allergies"),T="save_emr_config.php?ph="+f+"&fh="+b+"&pastdx="+x+"&medications="+D+"&immunizations="+w+"&allergies="+k+"&address="+o+"&address2="+l+"&city="+s+"&state="+c+"&country="+d+"&notes="+p+"&fractures="+v+"&surgeries="+h+"&otherknown="+g+"&obstetric="+_+"&othermed="+$+"&father="+y+"&mother="+I+"&siblings="+C+"&phone="+m+"&insurance="+u,O=LanzaAjax(T);alert("success"==O?"Changes Saved Successfully !!!":"Error Saving Changes !!!")}function get_checkbox_value(e){var t=document.getElementById(e),i=0;return t.checked&&(i=1),i}function saveSchedulerConfig(){for(var e="clear_scheduler_data.php",t=LanzaAjax(e),i=0;predefined_events>i;i++)if(-1==deleted_elements.indexOf(i))var a=$("#event"+i).val(),r=$("#hours"+i).val(),n=$("#minutes"+i).val(),o=$("#colour"+i).val(),l="create_type_config_entry.php?title="+a+"&hours="+r+"&minutes="+n+" &colour="+o,t=LanzaAjax(l);var l="save_notify_time.php?id="+$("#notify_id").val()+"&minutes="+$("#appoint_notify").val();t=LanzaAjax(l);var s="save_user_timezone.php?userid="+med_id+"&timez="+$("#Timezone").val();Rectipo=LanzaAjax(s),window.location.replace("/scheduler-n.php?curr_source="+med_id)}function add_visit_types(){add_event_config(predefined_events,"",0,0,"ffffff")}function add_event_config(e,t,i,a,r){var n=document.getElementById("CLICK_EVENT"),o=document.createElement("div");o.setAttribute("class","formRow"),o.setAttribute("id","row"+e),o.innerHTML="Type : ";var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("id","event"+e),l.setAttribute("name","event"+e),l.setAttribute("value",t),l.style.width="8em",o.appendChild(l),o.innerHTML+="  Hours : ";var s=document.createElement("select");s.setAttribute("id","hours"+e),s.setAttribute("name","hours"+e),s.style.width="8em";for(var c=0;25>c;c++)s.options[s.options.length]=new Option(c,c);s.options[parseInt(i)].setAttribute("selected",!0),o.appendChild(s),o.innerHTML+="  Minutes : ";var d=document.createElement("select");d.setAttribute("id","minutes"+e),d.setAttribute("name","minutes"+e),d.style.width="8em";for(var c=0;61>c;c++)d.options[d.options.length]=new Option(c,c);d.options[parseInt(a)].setAttribute("selected",!0),o.appendChild(d),o.innerHTML+="  Pick Colour: ";var p=document.createElement("INPUT");p.style.width="5em",p.setAttribute("id","colour"+e),p.setAttribute("name","colour"+e);var m=new jscolor.color(p);m.fromString(r),o.appendChild(p);var u=document.createElement("input");u.setAttribute("type","image"),u.setAttribute("id","but_"+e),u.setAttribute("src","images/del_button.jpg"),u.style.width="20px",u.style.height="20px",u.onclick=function(){var e=this.id.split("_"),t="row"+e[1],i=document.getElementById(t);i.parentNode.removeChild(i),deleted_elements.push(e[1])},o.appendChild(u),n.appendChild(o),predefined_events++}function checkowner(){var e=LanzaAjax("CheckOwner.php?docid="+med_id+"&groupid="+groupid);return e>0?$("input.group1").attr("disabled",!0):$("input.group1").removeAttr("disabled"),e}function resizeAndUpload(e){var t=new FileReader;t.onloadend=function(){var e=new Image;e.src=t.result,e.onload=function(){var t=400,i=300,a=e.width,r=e.height;a>r?a>t&&(r*=t/a,a=t):r>i&&(a*=i/r,r=i);var n=document.createElement("canvas");n.width=a,n.height=r;var o=n.getContext("2d");o.drawImage(this,0,0,a,r),dataURL=n.toDataURL("image/jpeg");var l=document.createElement("div");l.innerHTML='<img style="width:150px;height:150px;margin-bottom:10px;" src="'+dataURL+'" />',1==whichimage?$("#grpimage").html(l):2==whichimage&&$("#creategrpimage").html(l);var s=new XMLHttpRequest;if(s.onreadystatechange=function(){var t=document.createElement("div");t.innerHTML='<img style="width:150px;height:150px;margin-bottom:10px;" src="'+dataURL+'" />',1==whichimage?$("#grpimage").html(t):2==whichimage&&$("#grpimage").html(t)},1==whichimage){s.open("POST","uploadResized.php?groupid="+groupid,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded");var c="image="+dataURL;s.send(c)}}},t.readAsDataURL(e)}function GetGroupData(e){$.ajax({url:e,dataType:"json",async:!1,success:function(e){group_data=e.items}})}function getDateDay(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return t[e]}function getDateRepresentation(e){if("th"==language)var t=["Ene","Feb","Mar","Abr","May","June","July","Ago","Sep","Oct","Nov","Dic"];else var t=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"];var i=e.getDate(),a=t[e.getMonth()],r=e.getFullYear();return a+" "+i+","+r}function getDateDatabaseRepresentation(e){var t=e.getDate(),i=e.getMonth()+1,a=e.getFullYear();return a+"-"+i+"-"+t}function getTimeRepresentation(e){var t=e.split(":"),i=parseInt(t[0]),a=parseInt(t[1]),r="am";return 0==i?(i=12,r="am"):i>12?(i-=12,r="pm"):12==i&&(r="pm"),0==a?i+".00 "+r:i+"."+a+" "+r}function showAppointmentData(e){var t=new Date(e),r=(new Date,'<button type="button" id="popover_btn" data-container="body" data-toggle="popover" data-placement="left" style="float: right; background-color: #FFF; outline: 0px; border: 0px solid #FFF;" data-content="To add a new availability timeslot, simply click on the time where you would like it to start, and then click on the time where you would like it to end.<br/><br/>To delete an availability timeslot, simply click on it and select \'OK\'. "><i class="icon-info-sign"></i></button>');for(i=0;7>i;++i){r+=6==i?'<div class="InfoRow" style="height:40px;padding-top:40px;padding-bottom:40px" id='+getDateDatabaseRepresentation(t)+">":'<div class="InfoRow" style="height:40px;padding-top:40px" id='+getDateDatabaseRepresentation(t)+">";var n="",o="";if("th"==language){"Sunday"==getDateDay(i)&&(n="Domingo"),"Monday"==getDateDay(i)&&(n="Lunes"),"Tuesday"==getDateDay(i)&&(n="Martes"),"Wednesday"==getDateDay(i)&&(n="Miércoles"),"Thursday"==getDateDay(i)&&(n="Jueves"),"Friday"==getDateDay(i)&&(n="Viernes"),"Saturday"==getDateDay(i)&&(n="Sábado");var l=getDateRepresentation(t),s=l.substring(0,3),c=l.substring(4,11);"Ene"==s&&(o="Ene "+c),"Feb"==s&&(o="Feb "+c),"Mar"==s&&(o="Mar "+c),"Abr"==s&&(o="Abr "+c),"May"==s&&(o="May "+c),"Jun"==s&&(o="Jun "+c),"Jul"==s&&(o="Jul "+c),"Ago"==s&&(o="Ago "+c),"Sep"==s&&(o="Sep "+c),"Oct"==s&&(o="Oct "+c),"Nov"==s&&(o="Nov "+c),"Dic"==s&&(o="Dic "+c)}else if("en"==language){"Sunday"==getDateDay(i)&&(n="Sunday"),"Monday"==getDateDay(i)&&(n="Monday"),"Tuesday"==getDateDay(i)&&(n="Tuesday"),"Wednesday"==getDateDay(i)&&(n="Wednesday"),"Thursday"==getDateDay(i)&&(n="Thursday"),"Friday"==getDateDay(i)&&(n="Friday"),"Saturday"==getDateDay(i)&&(n="Saturday");var d=getDateRepresentation(t),p=d.substring(0,3),m=d.substring(4,11);"Jan"==p&&(o="Jan "+m),"Feb"==p&&(o="Feb "+m),"Mar"==p&&(o="Mar "+m),"Apr"==p&&(o="Apr "+m),"May"==p&&(o="May "+m),"Jun"==p&&(o="Jun "+m),"Jul"==p&&(o="Jul "+m),"Aug"==p&&(o="Aug "+m),"Sep"==p&&(o="Sep "+m),"Oct"==p&&(o="Oct "+m),"Nov"==p&&(o="Nov "+m),"Dec"==p&&(o="Dec "+m)}r+='<div style="width:100px; float:left; margin-left:10px"><span class="PatName">'+o+"</span>",r+='<div style="width:100%;"></div>',r+='<div style="width:100px; float:left; margin-left:10px"><span>'+n+"</span></div>",r+="</div>",r+='<div style="float:left; text-align:left;">'+generateTimeline(i)+"</div>",r+="</div>",t.setDate(t.getDate()+1)}for($("#AppointmentContainer").html(r),$("#popover_btn").popover(),t=new Date(e),i=0;7>i;++i)loadTimeSlots(t,i),t.setDate(t.getDate()+1)}function generateTimeline(e){var t='<div class="timeCell" id="tc'+e+'_1" ><div class="timeCellIndicator" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px; -webkit-border-top-left-radius: 3px; -moz-border-top-left-radius: 3px;  -webkit-border-bottom-left-radius: 3px; -moz-border-bottom-left-radius: 3px;"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff" ></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">12 am</span></div> <div class="timeCell" id="tc'+e+'_2"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">1 am</span></div> <div class="timeCell" id="tc'+e+'_3"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">2 am</span></div> <div class="timeCell" id="tc'+e+'_4"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">3 am</span></div> <div class="timeCell" id="tc'+e+'_5"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">4 am</span></div> <div class="timeCell" id="tc'+e+'_6"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">5 am</span></div> <div class="timeCell" id="tc'+e+'_7"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">6 am</span></div> <div class="timeCell" id="tc'+e+'_8"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">7 am</span></div> <div class="timeCell" id="tc'+e+'_9"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">8 am</span></div> <div class="timeCell" id="tc'+e+'_10"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">9 am</span></div> <div class="timeCell" id="tc'+e+'_11"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">10 am</span></div> <div class="timeCell" id="tc'+e+'_12"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">11 am</span></div> <div class="timeCell" id="tc'+e+'_13"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">12 pm</span></div> <div class="timeCell" id="tc'+e+'_14"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">1 pm</span></div> <div class="timeCell" id="tc'+e+'_15"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">2 pm</span></div> <div class="timeCell" id="tc'+e+'_16"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">3 pm</span></div> <div class="timeCell" id="tc'+e+'_17"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">4 pm</span></div> <div class="timeCell" id="tc'+e+'_18"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">5 pm</span></div> <div class="timeCell" id="tc'+e+'_19"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">6 pm</span></div> <div class="timeCell" id="tc'+e+'_20"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">7 pm</span></div> <div class="timeCell" id="tc'+e+'_21"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">8 pm</span></div> <div class="timeCell" id="tc'+e+'_22"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">9 pm</span></div> <div class="timeCell" id="tc'+e+'_23"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">10 pm</span></div> <div class="timeCell" id="tc'+e+'_24"><div class="timeCellIndicator" style="border-top-right-radius: 3px; border-bottom-right-radius: 3px; -webkit-border-top-right-radius: 3px; -moz-border-top-right-radius: 3px;  -webkit-border-bottom-right-radius: 3px; -moz-border-bottom-right-radius: 3px;"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff" ></div></div><span class="timeLabel">11 pm</span></div>';return t}function getWeeklyTimeslots(e){var t=e.getDate(),i=e.getMonth()+1,a=e.getFullYear(),r=a+"-"+i+"-"+t,n="getDoctorWeeklySchedule.php?week="+r;$.ajax({url:n,dataType:"json",async:!1,success:function(e){TimeSlotData=e},error:function(e,t){alert(t)}})}function loadTimeSlots(e,t){if(numTimeSlots=TimeSlotData.length,0!=numTimeSlots){var i=e.getUTCDay(),a=i+1,r=i-1;a>6&&(a=0),0>r&&(r=6);for(var n=0;numTimeSlots>n;n++){var o=TimeSlotData[n],l=o.split("_"),s=parseInt(l[0]),c=l[1],d="event_"+s,p=new Date(2e3,1,2,0,0,0,0);p.setUTCFullYear(parseInt(c.substr(14,4)),parseInt(c.substr(18,2))-1,parseInt(c.substr(20,2))),p.setHours(0),p.setMinutes(0);var m=new Date;m.setUTCDate(p.getDate()+6),m.setHours(23),m.setMinutes(59),m.setSeconds(59);var u=parseInt(c.substr(1,2)),f=parseInt(c.substr(3,2)),v=parseInt(c.substr(5,2)),h=parseInt(c.substr(7,2)),g=0;if("+"==c.substr(9,1)&&(g=1),g){var _=parseInt(c.substr(10,2)),b=parseInt(c.substr(12,2));u-=_,v-=_,f-=b,h-=b,f>=60?(f-=60,u+=1):0>f&&(f+=60,u-=1),h>=60?(h-=60,v+=1):0>h&&(h+=60,v-=1)}else{var _=parseInt(c.substr(10,2)),b=parseInt(c.substr(12,2));u+=_,v+=_,f+=b,h+=b,f>=60?(f-=60,u+=1):0>f&&(f+=60,u-=1),h>=60?(h-=60,v+=1):0>h&&(h+=60,v-=1)}var y=parseFloat($("#timezone_picker").val()),I=Math.floor(y),C=60*(y-I);if(0==g&&(I=Math.ceil(y),C=60*(y-I)),u+=I,v+=I,f+=C,h+=C,f>=60?(f-=60,u+=1):0>f&&(f+=60,u-=1),h>=60?(h-=60,v+=1):0>h&&(h+=60,v-=1),parseInt(c[0])==a?(u+=24,v+=24):parseInt(c[0])==r&&(u-=24,v-=24),(parseInt(c[0])==i||parseInt(c[0])==a||parseInt(c[0])==r)&&24>u){if(u==v){var x=1;x=0==f?1:f/15+1;for(var D=h/15,w=1;5>w;++w)if(w>=x&&D>=w)switch(w){case 1:$("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+d);break;case 2:$("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+d);break;case 3:$("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+d);break;case 4:$("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+d)}continue}if(u>=0){var x=f/15,D=h/15;3>=x&&($("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+d),2>=x&&($("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+d),1>=x&&($("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+d),0==x&&$("#tc"+t+"_"+(u+1)).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+d))))}var k=u+2;1>k&&(k=1);var T=v;for(T>24&&(T=24);T>=k;k++)$("#tc"+t+"_"+k).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+d),$("#tc"+t+"_"+k).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+d),$("#tc"+t+"_"+k).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+d),$("#tc"+t+"_"+k).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+d);24>v&&D>=1&&($("#tc"+t+"_"+(v+1)).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+d),D>=2&&($("#tc"+t+"_"+(v+1)).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+d),D>=3&&$("#tc"+t+"_"+(v+1)).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+d)))}}}}function uncolorEventFromRow(e,t){for(var i="event_"+t,a=0;25>a;++a){var r=generateID(e,a);$(r).children(".timeCellIndicator").children().first().hasClass(i)&&$(r).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOff"),$(r).children(".timeCellIndicator").children().first().next().hasClass(i)&&$(r).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOff"),$(r).children(".timeCellIndicator").children().last().prev().hasClass(i)&&$(r).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOff"),$(r).children(".timeCellIndicator").children().last().hasClass(i)&&$(r).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOff")}}function getIndexFromTime(e){var t=e.split(":"),i=parseInt(t[1]);switch(i){case 0:return 1;case 15:return 2;case 30:return 3;case 45:return 4}}function getTime(e,t){var i=e.split(" "),a=parseInt(i[0]);"pm"==i[1]?12!=a&&(a+=12):12==a&&(a=0);var r="00",n="00";switch(t){case 1:r="00";break;case 2:r="15";break;case 3:r="30";break;case 4:r="45"}return a+":"+r+":"+n}function add15min(e){var t=e.split(":"),i=parseInt(t[0]),a=parseInt(t[1]);return a+=15,60==a?(i+=1,24==i?"00:00:00":i+":00:00"):i+":"+a+":00"}function createTimeslot(e,t,i){var a=getDateDatabaseRepresentation(startDate),r=$("#timezone_picker").val().toString(),n="";"-"==r.charAt(0)&&(n="-",r=r.replace("-",""));var o=r.split(".");1==o[0].length&&(n+="0"),n+=o[0],n+=":",1==o[1].length&&(n+="0"),n+=o[1];var l="createDoctorTimeslot.php?startDate="+a+"&startTime="+e+"&endTime="+t+"&weekday="+i+"&timezone="+n;console.log(l);var s=LanzaAjax(l);return parseInt(s)}function getColumnFromId(e){var t=e.split("_");return parseInt(t[1])}function getRowFromId(e){var t=e.split("_");return parseInt(t[0].substr(t[0].length-1,1))}function generateID(e,t){return"#tc"+e+"_"+t}function colorSlot(e,t,i,a){var r="event_"+a;if(t==i){var n=t,o=generateID(e,n);if($(o).children(".timeCellIndicator").children().hasClass("tempSelection")){var l=0,s=0;($(o).children(".timeCellIndicator").children().first().hasClass("tempSelection")||d)&&(l=1,s=1),($(o).children(".timeCellIndicator").children().first().next().hasClass("tempSelection")||d)&&(0==l&&(l=2),s=2),($(o).children(".timeCellIndicator").children().last().prev().hasClass("tempSelection")||d)&&(0==l&&(l=3),s=3),($(o).children(".timeCellIndicator").children().last().hasClass("tempSelection")||d)&&(0==l&&(l=4),s=4);for(var c=1;5>c;++c)if(c>=l&&s>=c)switch(c){case 1:$(o).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+r);break;case 2:$(o).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+r);break;case 3:$(o).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+r);break;case 4:$(o).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+r)}}}else{for(n=t;i>n;n++){var o=generateID(e,n);if($(o).children(".timeCellIndicator").children().hasClass("tempSelection")){var d=!1;($(o).children(".timeCellIndicator").children().first().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().first().next().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().last().prev().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().last().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+r))}else $(o).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+r),$(o).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+r),$(o).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+r),$(o).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+r)}var o=generateID(e,i);if($(o).children(".timeCellIndicator").children().hasClass("tempSelection")){var d=!1;($(o).children(".timeCellIndicator").children().last().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().last().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().last().prev().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().last().prev().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().first().next().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().first().next().attr("class","timeCellIndicatorOn "+r)),($(o).children(".timeCellIndicator").children().first().hasClass("tempSelection")||d)&&(d=!0,$(o).children(".timeCellIndicator").children().first().attr("class","timeCellIndicatorOn "+r))}}}function updateGroupInfo(){var e=$("#editgrpname").val(),t=$("#editgrpadd").val(),i=$("#editgrpzip").val(),a=$("#editgrpcity").val(),r=$("#editgrpstate").val(),n=$("#editgrpcountry").val();if(group_dialog.dialog("close"),""==e||""==t||""==i||""==a||""==r||""==n)alert("Empty field not allowed");else{var o="SaveGroup.php?grpname="+e+"&grpadd="+t+"&grpzip="+i+"&grpcity="+a+"&grpstate="+r+"&grpcountry="+n+"&groupid="+groupid,l=LanzaAjax(o);if(1==l){var s=LanzaAjax("getGroupDetails.php?docid="+med_id);$("#group_details").html(s)}$("#editgrpname").attr("disabled","disabled"),$("#editgrpadd").attr("disabled","disabled"),$("#editgrpzip").attr("disabled","disabled"),$("#editgrpcity").attr("disabled","disabled"),$("#editgrpstate").attr("disabled","disabled"),$("#editgrpcountry").attr("disabled","disabled"),$("#filesToUpload").attr("disabled","disabled"),$("#save_grpdate").hide()}e="",t="",i="",a="",r="",n=""}var med_id=$("#MEDID").val(),doc_speciality=$("#DOC_SPECIALITY").val(),doc_email=$("#IdMEDEmail").val(),doc_timezone=$("#DOC_TIMEZONE").val(),doc_state=$("#DOC_STATE").val(),doc_country=$("#DOC_COUNTRY").val(),custom_look=$("#CUSTOM_LOOK").val(),message_holder=$("#MESSAGE").val(),timestamp_holder=$("#TIMESTAMP").val(),unique_salt=$("#UNIQUE_SALT").val(),timeoutTime=18e6,timeoutTimer=setTimeout(ShowTimeOutWarning,timeoutTime),predefined_events=0,deleted_elements=new Array,active_session_timer=6e4,sessionTimer=setTimeout(inform_about_session,active_session_timer),group_dialog=$("#create-group").dialog({bgiframe:!0,width:650,height:550,modal:!1,autoOpen:!1,title:"Create Group"});$("#create-group-btn").live("click",function(){console.log("group dialog"),$("#Edit_group").hide(),$("#save_grpdate").show(),$("#editgrpname").val(""),$("#editgrpadd").val(""),$("#editgrpzip").val(""),$("#editgrpcity").val(""),$("#editgrpstate").val(""),$("#editgrpcountry").val(""),$("#editgrpname").removeAttr("disabled"),$("#editgrpadd").removeAttr("disabled"),$("#editgrpzip").removeAttr("disabled"),$("#editgrpcity").removeAttr("disabled"),$("#editgrpstate").removeAttr("disabled"),$("#editgrpcountry").removeAttr("disabled"),$("#filesToUpload").removeAttr("disabled"),group_dialog=$("#create-group").dialog({bgiframe:!0,width:650,height:550,modal:!1,autoOpen:!1,title:"Create Group"}),group_dialog.dialog("open"),$("#grpimage").html('<img style="width:150px;height:150px;margin-bottom:10px" src="images/defaultgrouppic.jpg" alt="Group Picture"/>')}),$("#file_upload").uploadify({method:"post",formData:{timestamp:timestamp_holder,token:unique_salt},swf:"js/uploadify/uploadify.swf",uploader:"uploadifyDoctor.php",multi:!1,onUploadSuccess:function(e,t){var a=t.split("|");if("1"==a[1])return void alert("Kindly upload image of minimum dimensions 70X70");if("fileError"==a[0])return alert("Please select a file belonging to one of the following types: jpeg,gif or png"),void $("#doctorImage").attr("src","DoctorImage/defaultDP.jpg");var r=new Date;$("#doctorImage").attr("src",a[0]+"?"+r.getTime())}}),$("#Vphone").intlTelInput(),$("#Vphone").bind("focusout",function(){}),$(window).load(function(){$(".loader_spinner").fadeOut("slow")}),$(document).ready(function(){function p(e,t){t.error?($(".credit_card_notification").css("background-color","#D5483A"),$(".credit_card_notification").text("Unable To Add Bank Account"),$(".credit_card_notification").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$(".credit_card_notification").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}})):($("#credit_card_loader").css("visibility","visible"),$.post("change_credit_card.php",{type:"1",action:"1",id:$("#USERDID").val(),token:t.id,full_name:$("#bank_account_name").val()},function(e){console.log(e),$("#credit_card_loader").css("visibility","hidden"),"1"==e?($(".credit_card_notification").css("background-color","#52D859"),$(".credit_card_notification").text("Bank Account Added!"),$(".credit_card_notification").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$(".credit_card_notification").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}),$.post("get_doctor_credit_cards.php",{id:$("#USERDID").val()},function(e){var i=JSON.parse(e);null!=i.active_account&&null!=i.active_account.last4&&i.active_account.last4.length>0&&($("#current_bank_account_number").text("********"+i.active_account.last4),$("#current_bank_account_country").removeClass(),$("#current_bank_account_country").addClass("flag-icon-background"),$("#current_bank_account_country").addClass("flag-icon-"+i.active_account.country.toLowerCase()),$(".credit_card_row").css("display","block"))})):($(".credit_card_notification").css("background-color","#D5483A"),$(".credit_card_notification").text("Unable To Add Bank Account"),$(".credit_card_notification").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$(".credit_card_notification").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}))}))}function m(e){return e.split(/[\\/]/).pop()}function u(e,t){var i=e.split("_")[2];if(f.hasOwnProperty(t)){var a=f[t];$("#certification_image_"+i).attr("src",a),$("#certification_filename_"+i).val(m(a))}else $("#certification_image_"+i).attr("src","CertificationImages/none.jpg"),$("#certification_filename_"+i).val("");$("#certification_filedata_"+i).val("")}function g(){$.get("get_appointments.php?doc_id="+$("#MEDID").val(),function(e){console.log(e),h=JSON.parse(e),_()})}function _(){var e="",t="",i=null,a="",r=0,n=null,o=null,l=0,s=0,c="AM",d="AM",p=new Object,m=h.length;0==m&&(a="<div style='font-size:14px; text-align:center; width:100%;'>There are currently no appointments scheduled.</div>");for(var u=0;u<h.length;++u){var f=!1,v=!1;h[u].date!=e&&(e=h[u].date,i=new Date,i.setFullYear(parseInt(e.substr(0,4))),i.setMonth(parseInt(e.substr(5,2))-1),i.setDate(parseInt(e.substr(8,2))),a+='<h3 style="text-align: center; font-size: 20px;">',a+=i.toDateString(),a+="</h3>",f=!0,t=""),h[u].start_time!=t&&(t=h[u].start_time,v=!0,r=0,a+='<div style="text-align: center; margin-right: 10px; background-color: #7EC1FF;',f&&(a+=" border-top-left-radius: 8px; border-top-right-radius: 8px;"),a+=' color: #FFF; font-size: 16px; font-weight: bold; padding: 5px;">',n=h[u].start_time.split(":"),o=h[u].end_time.split(":"),l=parseInt(n[0]),s=parseInt(o[0]),c="AM",d="AM",l>11?(c="PM",l>12&&(l-=12)):0==l&&(l=12,c="AM"),s>11?(d="PM",s>12&&(s-=12)):0==s&&(s=12,d="AM"),a+=l+":"+n[1]+" "+c+" - "+s+":"+o[1]+" "+d,a+="</div>"),a+='<div style="text-align: left; margin-right: 10px; background-color: ',a+=r%2==1?"#E3E3E3;":"#F3F3F3;",a+=" color: #000; font-size: 14px; padding: 4px; padding-left: 10px;",(u<h.length-1&&h[u+1].date!=e||u==h.length-1)&&(a+=" border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;"),a+='"><button id="',a+="app_del_"+h[u].id+"_"+u,a+='" style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>',a+='<div style="width: 650px; height: 22px;">',a+='<div style="width: 315px; float: left;">',a+='<a href="patientdetailMED-new.php?IdUsu='+h[u].pat_id+'" style="color: #46D542;">'+h[u].pat_name+"</a></div>",a+='<div style="width: 140px; float: left; color: #777;">Set a specific time: </div>',a+='<input id="specific_time_'+h[u].id+"_"+l+":"+n[1]+c.toLowerCase()+"_"+s+":"+o[1]+d.toLowerCase()+'" value="" type="text" style="width: 75px; padding: 0px; padding-left: 5px; margin-bottom: 0px; height: 20px; float: left;" ',null!=h[u].specific_time&&(p[h[u].id]=h[u].specific_time),a+="/>",a+='<button class="app_save" style="height: 22px; width: 50px; background-color: inherit; border-radius: 2px; color: #22AEFF; border: 0px solid #FFF; outline: 0px;">Save</button>',a+='<button class="app_clear" style="height: 22px; width: 50px; background-color: inherit; border-radius: 2px; color: #D84840; border: 0px solid #FFF; outline: 0px;">Clear</button>',a+="</div></div>",++r
}a+="<br/><br/>",$("#appointments_container").html(a),$("input[id^='specific_time_']").each(function(){var i=$(this).attr("id").split("_");if($(this).timepicker({step:5,minTime:i[3],maxTime:i[4]}),i[2]in p){var a=new Date,r=p[i[2]].split(":");a.setHours(parseInt(r[0])),a.setMinutes(parseInt(r[1])),$(this).timepicker("setTime",a)}}),$("#app_clear").off("click"),$("input[id^='specific_time_']").off("change"),$("button[id^='app_del_']").on("click"),$(".app_clear").on("click",function(){$(this).parent().children("input[id^='specific_time_']").val("");var e=$(this).parent().children("input[id^='specific_time_']").attr("id").split("_");$.post("update_appointment.php",{id:e[2],specific_time:"n"},function(e){console.log(e)})}),$("input[id^='specific_time_']").on("change",function(){var e=$(this).attr("id").split("_");console.log(e[2]+" "+$(this).val()),$.post("update_appointment.php",{id:e[2],specific_time:$(this).val()},function(e){console.log(e)})}),$(".app_save").on("click",function(){var e=$(this).prev().attr("id").split("_");$.post("update_appointment.php",{id:e[2],specific_time:$(this).prev().val()},function(e){console.log(e)}),alert("Appointment Saved")}),$("button[id^='app_del_']").on("click",function(){var t=($(this).parent(),confirm("Are you sure you want to cancel this appointment with member "+$(this).parent().children("div").children("div").children("a").eq(0).text()+"? This action cannot be undone."));if(t){var i=$(this).attr("id").split("_");$.get("delete_appointment.php?id="+i[2],function(e){"1"==e&&(h.splice(i[3],1),_())})}})}function x(){var e=$("#dp32").val(),t=e.substr(6,4)+e.substr(3,2)+e.substr(0,2),i=w($("#c2").is(":checked")),i=$("#gender").val(),a=$("#orderOB").val();0==i&&(i="0"),0==a&&(a="0");var r=t+i+a;$("#VIdUsFIXED").html(r),$("#VIdUsFIXEDINSERT").val(r)}function D(){var e=$("#Vname").val().toLowerCase().replace(".","").replace(" ",""),t=$("#Vsurname").val().toLowerCase().replace(".","").replace(" ",""),i=e+"."+t;$("#VIdUsFIXEDNAME").html(i),$("#VIdUsFIXEDNAMEINSERT").val(i)}function w(e){return e?1:0}function k(e){var t="SIN MODIFICACIÓN";return $.ajax({url:e,dataType:"html",async:!1,complete:function(){},success:function(e){"string"==typeof e&&(t=e)}}),t}function T(e){var t={title:"status",text:e,image:"images/Icono_H2M.png",sticky:!1,time:"3000"};$.gritter.add(t)}function O(e,t){var i=document.getElementById(e);if(1==t)if(i.checked="checked","emr_family"==e){$("#FA_Tab").css("display","inherit");var a=w($("#emr_family").is(":checked"));1==a?$("#FA_Tab").css("display","inherit"):$("#FA_Tab").css("display","none")}else if("emr_personal"==e){$("#PH_Tab").css("display","inherit");var a=w($("#emr_personal").is(":checked"));1==a?$("#PH_Tab").css("display","inherit"):$("#PH_Tab").css("display","none")}}var e=k("getGroupDetails.php?docid="+med_id);$("#group_details").html(e);var t=new Pusher("d869a07d8f17a76448ed"),i=$("#MEDID").val(),a=t.subscribe(i);a.bind("notification",function(e){displaynotification("New Message",e)});var r="",n=!1;"undefined"!=message_holder&&(r=message_holder),r.length>0&&(alert(r),window.location="medicalConfiguration.php"),$("#change_password_validate_button").live("click",function(){$.post("validate_password.php",{doc_id:$("#USERDID").val(),pw:$("#pw1").val()},function(e){console.log(e),"1"==e&&"none"==$("#change_password_validated_section").css("display")?$("#change_password_validated_section").slideDown():($("#password_notification").css("background-color","#D5483A"),$("#password_notification").html('<p style="color: #fff;">Password Incorrect</p>'),$("#password_notification_container").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$("#password_notification_container").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}))})}),$("#reset_availability_button").on("click",function(){$.post("reset_doctor_availability.php",{ID:$("#USERDID").val()},function(e){"1"==e&&$("#consultation_status_label").html('You are currently: <span style="color: #54bc00;">Not in consultation</span>')})});var o="";"th"==language?o="Contraseña Cambiada":"en"==language&&(o="Password Changed Successfully!"),$("#change_password_finish_button").live("click",function(){$("#pw2").val()==$("#pw3").val()?($("#pw1").val(""),$("#change_password_validated_section").slideUp(),$.post("update_doctor.php",{new_pw:$("#pw2").val(),doc_id:$("#USERDID").val()},function(){$("#pw2").val(""),$("#pw3").val(""),$("#password_notification").css("background-color","#52D859"),$("#password_notification").html('<p style="color: #fff;">'+o+"</p>"),$("#password_notification_container").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$("#password_notification_container").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}})})):($("#password_notification").css("background-color","#D5483A"),$("#password_notification").html('<p style="color: #fff;">Passwords Did Not Match</p>'),$("#password_notification_container").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$("#password_notification_container").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}))}),$(window).bind("beforeunload",function(){return n?"You have unsaved changes.":void 0}),$("#submit_button").on("click",function(){n=!1}),setTimeout(function(){$("#formID input").on("input",function(){n=!0}),$("#formID input").on("change",function(){n=!0}),$("#formID select").on("change",function(){n=!0})},2e3);var l=custom_look;"COL"==l?($("#appointments_tab").hide(),$("#payments_tab").hide()):($("#appointments_tab").show(),$("#payments_tab").show());var s=doc_country,c=doc_state;if(s.length>0&&($("#country").val(s).trigger("change"),console.log(s),"USA"==s&&$("#state").parent().parent().css("display","block"),c.length>0&&setTimeout(function(){$("#state").val(c)},100)),$("#country").on("change",function(){"USA"==$(this).val()?$("#state").parent().parent().css("display","block"):$("#state").parent().parent().css("display","none")}),$("#speciality").val(doc_speciality),"0"==$("#telemed_on").val()){var d="";"th"==language?d="No connectado":"en"==language&&(d="Offline"),$("#start_telemed").css("background-color","#F66765"),$("#start_telemed").css("border-color","#F66765"),$("#start_telemed").text(d)}else{var d="";"th"==language?d="En línea / Modo Editor":"en"==language&&(d="Online / Edit Mode"),$("#start_telemed").css("background-color","#74F677"),$("#start_telemed").css("border-color","#74F677"),$("#start_telemed").text(d)}$("#Haddress").keydown(function(e){var t=$(this).val().split("\n").length;return 13==e.keyCode&&t>=3?!1:void 0}),Stripe.setPublishableKey("pk_test_YBtrxG7xwZU9RO1VY8SeaEe9"),$("#add_card_button").on("click",function(){Stripe.bankAccount.createToken({country:$("#bank_account_country").val(),routingNumber:$("#bank_account_routing_number").val(),accountNumber:$("#bank_account_number").val()},p)}),$("#remove_card_button").on("click",function(){$("#credit_card_loader").css("visibility","visible"),$.post("change_credit_card.php",{type:"1",action:"2",id:$("#USERDID").val()},function(e){$("#credit_card_loader").css("visibility","hidden"),"1"==e?($(".credit_card_notification").css("background-color","#52D859"),$(".credit_card_notification").text("Bank Account Removed"),$(".credit_card_notification").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$(".credit_card_notification").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}),$(".credit_card_row").css("display","none")):($(".credit_card_notification").css("background-color","#D5483A"),$(".credit_card_notification").text("Unable To Remove Bank Account"),$(".credit_card_notification").animate({opacity:"1.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){setTimeout(function(){$(".credit_card_notification").animate({opacity:"0.0"},{duration:1e3,easing:"easeInOutQuad",complete:function(){}})},2e3)}}))})}),""!=$("#USERDID").val()&&$.post("get_doctor_credit_cards.php",{id:$("#USERDID").val()},function(e){var i=JSON.parse(e);null!=i.active_account&&null!=i.active_account.last4&&i.active_account.last4.length>0&&($("#current_bank_account_number").text("********"+i.active_account.last4),$("#current_bank_account_country").removeClass(),$("#current_bank_account_country").addClass("flag-icon-background"),$("#current_bank_account_country").addClass("flag-icon-"+i.active_account.country.toLowerCase()),$(".credit_card_row").css("display","block"))});var f,v;$.get("get_certifications.php",function(e){f=JSON.parse(e),v=Object.keys(f),$.post("get_certifications.php",{id:$("#MEDID").val()},function(e){var i=JSON.parse(e);$("#certifications_container").html("");for(var a=0;a<i.length;a++){for(var r="",n=$("#certifications_container").children().length+1;$("#certification_name_"+n).length;)n+=1;r+='<div style="width:85%; height: 70px; background-color: #FBFBFB; ',r+="1"==i[a].isPrimary?"border: 2px solid #22AEFF;":"border: 1px solid #E5E5E5;",r+=' padding: 2%; margin: auto; margin-bottom: 10px; margin-top: 15px; border-radius: 5px;">',r+='<div style="width: 220px; height: 70px; float: right;">',r+='<button class="certification_button" id="certification_changeimage_'+n+'" style="width: 45%; float: right; margin-left: 3%;">Change Image</button>',r+='<button class="certification_button" id="certification_makeprimary_'+n+'" style="width: 45%; float: right;">Make Primary</button>',r+='<input type="file" id="certification_file_'+n+'" name="certification_file_'+n+'" style="display: none;" />',r+='<input type="hidden" id="certification_filedata_'+n+'" name="certification_filedata_'+n+'" value="" />',r+='<input type="hidden" id="certification_filename_'+n+'" name="certification_filename_'+n+'" value="',null!=i[a].image&&i[a].image.length>0&&(r+=m(i[a].image)),r+='" />',r+='<input type="hidden" id="certification_primary_'+n+'" name="certification_primary_'+n+'" value="',r+="1"==i[a].isPrimary?"1":"0",r+='" />',r+='<button class="certification_button" style="background-color: #D84840; margin-top: 10px; width: 93%; float: right;">Delete</button>',r+="</div>",r+='<img id="certification_image_'+n+'" style="width: 70px; height: 70px; float: right; margin-right: 15px; border-radius: 70px; border: 1px solid #333;" src="',r+=null!=i[a].image&&i[a].image.length>0?i[a].image:"CertificationImages/none.jpg",r+='"/>',r+='<input type="checkbox" />',r+='<input type="text" id="certification_name_'+n+'" name="certification_name_'+n+'" placeholder="Certification Name" style="border: 1px solid #CCC; box-shadow: none; width: 216px; height: 25px; border-radius: 0px; padding: 4px; padding-left: 10px; margin-bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px; color: #989898;" value="',null!=i[a].name&&i[a].name.length>0&&(r+=i[a].name),r+='"  />',r+='<div style="width: 100%; height: 40px; margin-top: 0px;">',r+='<div style="height: 22px; width: 64px; border: 1px solid #CCC; border-right: 0px solid #333; float: left; padding: 4px; padding-left: 10px; padding-top: 7px; background-color: #FFF; color: #989898;  border-bottom-left-radius: 5px;">Start Date: </div>',r+='<input type="date" name="certification_date_'+n+'" id="certification_date_'+n+'"  style="height: 25px; width: 140px; float: left; border: 1px solid #CCC; border-left: 0px solid #333; border-radius: 0px; color: #989898; box-shadow: none; outline: 0px;  border-bottom-right-radius: 5px;" value="',null!=i[a].start_date&&i[a].start_date.length>0&&(r+=i[a].start_date),r+='" />',r+="</div>",r+="</div>",$("#certifications_container").append(r),$("#certifications_max_count").val()<n&&$("#certifications_max_count").val(n)}$(".certification_button").on("click",function(e){if(e.preventDefault(),"Change Image"==$(this).text()){var t=$(this).attr("id").split("_")[2];$("#certification_file_"+t).trigger("click")}else"Delete"==$(this).text()?$(this).parent().parent().remove():"Make Primary"==$(this).text()&&($(this).parent().parent().parent().children().each(function(){$(this).css("border","1px solid #E5E5E5"),$(this).children().eq(0).children("input").eq(3).val("0")}),$(this).parent().parent().css("border","2px solid #22AEFF"),$(this).parent().parent().children().eq(0).children("input").eq(3).val("1"))}),$('input[id^="certification_file_"]').change(function(){console.log("CERTIFICATION FILE");var e=$(this).attr("id").split("_")[2];if(this.files&&this.files[0]){console.log(this.files[0]);var t=new FileReader;t.onload=function(t){$("#certification_image_"+e).attr("src",t.target.result),$("#certification_filedata_"+e).val(t.target.result)},t.readAsDataURL(this.files[0]),$("#certification_filename_"+e).val(this.files[0].name)}}),$('input[id^="certification_name_"]').keyup(function(){u($(this).attr("id"),$(this).val())}),$('input[id^="certification_name_"]').autocomplete({source:v,select:function(e,t){u($(this).attr("id"),t.item.value)}})})}),$(".add_new_certification_button").on("click",function(e){e.preventDefault();for(var t="",i=$("#certifications_container").children().length+1;$("#certification_name_"+i).length;)i+=1;t+='<div style="width:85%; height: 70px; background-color: #FBFBFB; ',t+=1==i?"border: 2px solid #22AEFF; ":"border: 1px solid #E5E5E5; ",t+='padding: 2%; margin: auto; margin-bottom: 10px; margin-top: 15px; border-radius: 5px;">',t+='<div style="width: 220px; height: 70px; float: right;">',t+='<button class="certification_button" id="certification_changeimage_'+i+'" style="width: 45%; float: right; margin-left: 3%;">Change Image</button>',t+='<button class="certification_button" id="certification_makeprimary_'+i+'" style="width: 45%; float: right;">Make Primary</button>',t+='<input type="file" id="certification_file_'+i+'" name="certification_file_'+i+'" style="display: none;" />',t+='<input type="hidden" id="certification_filedata_'+i+'" name="certification_filedata_'+i+'" value="" />',t+='<input type="hidden" id="certification_filename_'+i+'" name="certification_filename_'+i+'" value="" />',t+='<input type="hidden" id="certification_primary_'+i+'" name="certification_primary_'+i+'" value="',t+=1==i?"1":"0",t+='" />',t+='<button class="certification_button" style="width: 93%; background-color: #D84840; margin-top: 10px; float: right;">delete</button>',t+="</div>",t+='<img id="certification_image_'+i+'" style="width: 70px; height: 70px; float: right; margin-right: 15px; border-radius: 70px; border: 1px solid #333;" src="CertificationImages/none.jpg"/>',t+='<input type="text" id="certification_name_'+i+'" name="certification_name_'+i+'" placeholder="Certification Name" style="border: 1px solid #CCC; box-shadow: none; width: 216px; height: 25px; border-radius: 0px; padding: 4px; padding-left: 10px; margin-bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px; color: #989898;"  />',t+='<div style="width: 100%; height: 40px; margin-top: 0px;">',t+='<div style="height: 22px; width: 64px; border: 1px solid #CCC; border-right: 0px solid #333; float: left; padding: 4px; padding-left: 10px; padding-top: 7px; background-color: #FFF; color: #989898;  border-bottom-left-radius: 5px;">Start Date: </div>',t+='<input type="date" name="certification_date_'+i+'" id="certification_date_'+i+'"  style="height: 25px; width: 140px; float: left; border: 1px solid #CCC; border-left: 0px solid #333; border-radius: 0px; color: #989898; box-shadow: none; outline: 0px;  border-bottom-right-radius: 5px;" />',t+="</div>",t+="</div>",$("#certifications_container").append(t),$("#certifications_max_count").val()<i&&$("#certifications_max_count").val(i),$(".certification_button").on("click",function(e){if(e.preventDefault(),"Change Image"==$(this).text()){var t=$(this).attr("id").split("_")[2];$("#certification_file_"+t).trigger("click")}else"Delete"==$(this).text()?$(this).parent().parent().remove():"Make Primary"==$(this).text()&&($(this).parent().parent().parent().children().each(function(){$(this).css("border","1px solid #E5E5E5"),$(this).children().eq(0).children("input").eq(3).val("0")}),$(this).parent().parent().css("border","2px solid #22AEFF"),$(this).parent().parent().children().eq(0).children("input").eq(3).val("1"))}),$('input[id^="certification_file_"]').change(function(){var e=$(this).attr("id").split("_")[2];if(this.files&&this.files[0]){var t=new FileReader;t.onload=function(t){$("#certification_image_"+e).attr("src",t.target.result),$("#certification_filedata_"+e).val(t.target.result)},t.readAsDataURL(this.files[0]),$("#certification_filename_"+e).val(this.files[0].name)}}),$('input[id^="certification_name_"]').keyup(function(){u($(this).attr("id"),$(this).val())}),$('input[id^="certification_name_"]').autocomplete({source:v,select:function(e,t){u($(this).attr("id"),t.item.value)}})}),$("#set_rate").live("click",function(){var e=/^\d+$/.test($("#rate").val());e?$.post("UpdateMEDUser.php",{telemed:!0,hr_rate:$("#rate").val(),EnviaUserid:$("#USERDID").val()},function(e){console.log(e)}):alert("Invalid rate amount, please try again")}),$("#start_telemed").live("click",function(){"0"==$("#telemed_on").val()?$.post("getTelemedAvailability.php",{get_telemed_info:1,med_id:$("#USERDID").val()},function(e){JSON.parse(e);$("#telemed_on").val("1"),$.post("getTelemedAvailability.php",{med_id:$("#USERDID").val(),set_on:1},function(){}),$("#start_telemed").css("background-color","#74F677"),$("#start_telemed").css("border-color","#74F677"),$("#start_telemed").text("Online / Edit Mode")}):($("#telemed_on").val("0"),$.post("getTelemedAvailability.php",{med_id:$("#USERDID").val(),set_on:0},function(){}),$("#start_telemed").css("background-color","#F66765"),$("#start_telemed").css("border-color","#F66765"),$("#start_telemed").text("Offline"))});var h=null;$("#app_config_button").live("click",function(){g()}),get_user_event_config("getusereventconfig.php");for(var b=0;b<event_config.length;b++)add_event_config(b,event_config[b].title,event_config[b].hours,event_config[b].minutes,event_config[b].colour);get_user_notify_time("getusernotifytime.php");for(var y=document.getElementById("appoint_notify"),I=1;61>I;I++)y.options[y.options.length]=new Option(I,I);y.options[parseInt(notify_time[0].minutes)-1].setAttribute("selected",!0),$("#notify_id").val(notify_time[0].id),get_timezones("gettimezones.php");for(var C=document.getElementById("Timezone"),b=0;b<timezones.length;b++)C.options[C.options.length]=new Option(timezones[b].timezones,timezones[b].id);get_user_timezone("getusertimezone.php"),C.options[parseInt(user_timezone[0].timez)-1].setAttribute("selected",!0),get_emr_config("getemrconfig.php"),O("emr_personal",emr_config[0].personal),O("emr_family",emr_config[0].family),O("emr_pastdx",emr_config[0].pastdx),O("emr_medications",emr_config[0].medications),O("emr_immunizations",emr_config[0].immunizations),O("emr_allergies",emr_config[0].allergies),O("emr_address",emr_config[0].address),O("emr_address2",emr_config[0].address2),O("emr_city",emr_config[0].city),O("emr_state",emr_config[0].state),O("emr_country",emr_config[0].country),O("emr_notes",emr_config[0].notes),O("emr_phone",emr_config[0].phone),O("emr_insurance",emr_config[0].insurance),O("emr_fractures",emr_config[0].fractures),O("emr_surgeries",emr_config[0].surgeries),O("emr_otherknown",emr_config[0].otherknown),O("emr_obstetric",emr_config[0].obstetric),O("emr_othermed",emr_config[0].othermed),O("emr_father",emr_config[0].father),O("emr_mother",emr_config[0].mother),O("emr_siblings",emr_config[0].siblings),$("body").bind("mousedown keydown",function(){clearTimeout(timeoutTimer),timeoutTimer=setTimeout(ShowTimeOutWarning,timeoutTime)}),$("#dp32").live("change",function(){x()}),$("#gender").bind("focusout change",function(){x()}),$("#orderOB").bind("focusout  change",function(){x()}),$("#Vname").bind("focusout  change",function(){D()}),$("#Vsurname").bind("focusout  change",function(){D()}),$("#c2").click(function(){$("#MULTIPLE").css("display","inherit");var t=w($("#c2").is(":checked"));1==t?$("#MULTIPLE").css("display","inherit"):($("#MULTIPLE").css("display","none"),$("#orderOB").val("0")),x()}),$("#emr_personal").click(function(){$("#PH_Tab").css("display","inherit");var t=w($("#emr_personal").is(":checked"));1==t?$("#PH_Tab").css("display","inherit"):$("#PH_Tab").css("display","none")}),$("#emr_family").click(function(){$("#FA_Tab").css("display","inherit");var t=w($("#emr_family").is(":checked"));1==t?$("#FA_Tab").css("display","inherit"):$("#FA_Tab").css("display","none")}),setTimeout(function(){var e="/linkNotifications.php?idDoc="+med_id+"&state=0&value=0",t=k(e);parseInt(t)?$("#notify_link").prop("checked",!0):$("#notify_link").prop("checked",!1)},500),$("#notif_update").click(function(){var e=w($("#notify_link").is(":checked")),t="/linkNotifications.php?idDoc="+med_id+"&state=1&value="+e;k(t),T("Status Updated")})});var grptble=LanzaAjax("getGroupDetails.php?docid="+med_id);$("#group_details").html(grptble);var groupid=-1;$(".CFILADoctorEdit").live("click",function(){iconID=$(this).attr("id"),nameSplit=iconID.split("_"),groupid=nameSplit[1],console.log("Group ID : "+groupid),GetGroupData("getGroupData.php?groupid="+groupid);var e=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(e),$("#editgrpname").val(group_data[0].Name),$("#editgrpadd").val(group_data[0].Address),$("#editgrpzip").val(group_data[0].ZIP),$("#editgrpcity").val(group_data[0].City),$("#editgrpstate").val(group_data[0].State),$("#editgrpcountry").val(group_data[0].Country),$("#editgrpname").attr("disabled","disabled"),$("#editgrpadd").attr("disabled","disabled"),$("#editgrpzip").attr("disabled","disabled"),$("#editgrpcity").attr("disabled","disabled"),$("#editgrpstate").attr("disabled","disabled"),$("#editgrpcountry").attr("disabled","disabled"),$("#filesToUpload").attr("disabled","disabled");var t=document.createElement("div");console.log("Group Data Val "+group_data[0].Image),t.innerHTML=""!=group_data[0].Image?'<img style="width:150px;height:150px;margin-bottom:10px;" src="uploads/'+group_data[0].Image+'" />':'<img style="width:150px;height:150px;margin-bottom:10px;" src="images/defaultgrouppic.jpg" />',$("#grpimage").html(t),$("#groupconfig").dialog({bgiframe:!0,width:700,height:650,modal:!0}),checkowner()}),$("tr.CFILADoctor").live("mouseenter",function(){$(this).css("background","LightSteelBlue")}),$("tr.CFILADoctor").live("mouseleave",function(){$(this).css("background","")}),$(".edit_group").live("mouseenter",function(){$(this).css("cursor","pointer")}),$(".CFILADoctorEdit").live("mouseenter",function(){$(this).css("cursor","pointer")}),$('input[type=checkbox][id^="checkcol"]').live("click",function(){$(this).is(":checked")?$("#remove_doc").show():$("#remove_doc").hide()}),$('input[type=checkbox][id^="CFILAAdminRole"]').live("click",function(){var e=$(this).parents("tr.CFILAGroupDoc").attr("id"),t=checkowner();if(t>0)if($(this).is(":checked")){var i="addDoctorAsAdmin.php?groupid="+groupid+"&id="+e;LanzaAjax(i)}else{var i="RemoveDocAsAdmin.php?groupid="+groupid+"&id="+e;LanzaAjax(i)}else swal({title:"Error",text:"You do not have admin rights on this group.",type:"error",confirmButtonText:"Ok"});var r=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(r)}),$('input[type=checkbox][id^="CFILADocRole"]').live("click",function(){var e=$(this).parents("tr.CFILAGroupDoc").attr("id"),t=checkowner();if(t>0)if($(this).is(":checked")){var i="addDoctorAsRole.php?groupid="+groupid+"&id="+e+"&role=1";LanzaAjax(i)}else{var i="addDoctorAsRole.php?groupid="+groupid+"&id="+e+"&role=2";LanzaAjax(i)}else swal({title:"Error",text:"You do not have admin rights on this group.",type:"error",confirmButtonText:"Ok"});var r=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(r)}),$('input[type=checkbox][id^="CFILAStaffRole"]').live("click",function(){var e=$(this).parents("tr.CFILAGroupDoc").attr("id"),t=checkowner();if(t>0)if($(this).is(":checked")){var i="addDoctorAsRole.php?groupid="+groupid+"&id="+e+"&role=2";LanzaAjax(i)}else{var i="addDoctorAsRole.php?groupid="+groupid+"&id="+e+"&role=1";LanzaAjax(i)}else swal({title:"Error",text:"You do not have admin rights on this group.",type:"error",confirmButtonText:"Ok"});var r=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(r)}),$('input[type=checkbox][id^="CFILAReferralRole"]').live("click",function(){var e=$(this).parents("tr.CFILAGroupDoc").attr("id"),t=checkowner();if(t>0)if($(this).is(":checked")){var i="addDoctorAsRefIncharge.php?groupid="+groupid+"&id="+e;LanzaAjax(i)}else{var i="addDoctorAsRefIncharge?groupid="+groupid+"&id="+e;LanzaAjax(i)}else swal({title:"Error",text:"You do not have admin rights on this group.",type:"error",confirmButtonText:"Ok"});var r=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(r)}),checkowner(),$("#remove_doc").live("click",function(){var e=0,t=LanzaAjax("CheckOwner.php?docid="+med_id+"&groupid="+groupid);if(t>0){var i=confirm("Are you sure you want to remove this doctor from the group!Press Ok to confirm.");i&&$('input[type=checkbox][id^="checkcol"]').each(function(){var t=this.checked?"1":"0";if(1==t){var i=$(this).parents("tr.CFILAGroupDoc").attr("id"),a=$(this).parents("tr.CFILAGroupDoc").children("td.CFILADocname").attr("id");e+=1;var r="removeDocFromGroup.php?id="+i+"&groupid="+groupid+"&docid="+a;LanzaAjax(r)}});var a=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(a)}else swal({title:"Error",text:"Removal not allowed since you are not the group owner.",type:"error",confirmButtonText:"Ok"});$("#remove_doc").hide()});var DocList,VDocId=0,VDocName="";$.get("getValidDoctors.php",function(e){DocList=JSON.parse(e),$("#DoctorSBox").autocomplete({source:DocList,minLength:1,select:function(e,t){$("#field_id").val(t.item.id),$("#results_count").html(""),VDocName=t.item.label,VDocId=$("#field_id").val()},open:function(){var i=$(".ui-autocomplete > li").length;$("#results_count").html("(#"+i+")")},close:function(){$("#results_count").html("")},change:function(e,t){null===t.item&&($(this).val(""),$("#field_id").val(""))}})}),$("#DoctorSBox").focusout(function(){""===$("#field").val()&&$("#field_id").val("")});var whichimage=0,picuploaded=0;window.File&&window.FileReader&&window.FileList&&window.Blob?(document.getElementById("filesToUpload").onchange=function(){whichimage=1;for(var e=document.getElementById("filesToUpload").files,t=0;t<e.length;t++)resizeAndUpload(e[t])},document.getElementById("createfilesToUpload").onchange=function(){whichimage=2;for(var e=document.getElementById("createfilesToUpload").files,t=0;t<e.length;t++)resizeAndUpload(e[t])}):alert("The File APIs are not fully supported in this browser."),$("#add_doctors").live("click",function(){if(0==VDocId)alert("Please enter a valid Doctor Name");else{var e="addDoctorInGroup.php?groupid="+groupid+"&docid="+VDocId,t=LanzaAjax(e);if(0==t)alert("Doctor already present in the Group");else if(1==t){var i=LanzaAjax("getGroupDocs.php?docid="+med_id+"&groupid="+groupid);$("#group_members").html(i)}$("#DoctorSBox").val(""),VDocId=0}});var group_data,dataURL;$("#save_grpdate").live("click",function(){console.log("in create group");var e=$("#editgrpname").val(),t=$("#editgrpadd").val(),i=$("#editgrpzip").val(),a=$("#editgrpcity").val(),r=$("#editgrpstate").val(),n=$("#editgrpcountry").val();if(""==e||""==t||""==i||""==a||""==r||""==n)swal({title:"Error",text:"Empty field not allowed.",type:"error",confirmButtonText:"Ok"});else{var o="CreateGroup.php?grpname="+e+"&grpadd="+t+"&grpzip="+i+"&grpcity="+a+"&grpstate="+r+"&grpcountry="+n+"&docid="+med_id,l=LanzaAjax(o);if(console.log(l),l>0){var s=!0;if(grpimage=$("#grpimage img").attr("src"),"images/defaultgrouppic.jpg"!=grpimage&&(s=!1),0==s){var c=new XMLHttpRequest;c.onreadystatechange=function(){},c.open("POST","uploadResized.php?groupid="+l,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded");var d="image="+dataURL;c.send(d)}swal({title:"Group Created",text:"Group Created.",type:"success",confirmButtonText:"Ok"}),group_dialog.dialog("close");var p=LanzaAjax("getGroupDetails.php?docid="+med_id);$("#group_details").html(p)}$("#Groupname").val(""),$("#Groupadd").val(""),$("#Groupzip").val(""),$("#Groupcity").val(""),$("#Groupstate").val(""),$("#Groupcountry").val(""),$("#grpimage").html('<img style="width:150px;height:150px;margin-bottom:10px" src="images/defaultgrouppic.jpg" alt="Group Picture"/>')}e="",t="",i="",a="",r="",n=""}),$(".edit_group").live("click",function(){$("#Edit_group").show(),iconID=$(this).attr("id"),nameSplit=iconID.split("_"),groupid=nameSplit[1];var e=LanzaAjax("CheckOwner.php?docid="+med_id+"&groupid="+groupid);if(GetGroupData("getGroupData.php?groupid="+groupid),e>0){$("#editgrpname").val(group_data[0].Name),$("#editgrpadd").val(group_data[0].Address),$("#editgrpzip").val(group_data[0].ZIP),$("#editgrpcity").val(group_data[0].City),$("#editgrpstate").val(group_data[0].State),$("#editgrpcountry").val(group_data[0].Country),$("#editgrpname").removeAttr("disabled"),$("#editgrpadd").removeAttr("disabled"),$("#editgrpzip").removeAttr("disabled"),$("#editgrpcity").removeAttr("disabled"),$("#editgrpstate").removeAttr("disabled"),$("#editgrpcountry").removeAttr("disabled"),$("#filesToUpload").removeAttr("disabled"),$("#save_grpdate").hide();var t=document.createElement("div");console.log("Group Data Val "+group_data[0].Image),t.innerHTML=""!=group_data[0].Image?'<img style="width:150px;height:150px;margin-bottom:10px;" src="uploads/'+group_data[0].Image+'" />':'<img style="width:150px;height:150px;margin-bottom:10px;" src="images/defaultgrouppic.jpg" />',$("#grpimage").html(t),group_dialog=$("#create-group").dialog({bgiframe:!0,width:650,height:550,modal:!1,autoOpen:!1,title:"Edit Group"}),group_dialog.dialog("open")}else swal({title:"Error",text:"Group data edit not allowed since you are not the group owner.",type:"error",confirmButtonText:"Ok"})}),$("#Edit_group").live("click",function(){updateGroupInfo()}),timezone_db=doc_timezone;var current_timezone=get_timezone_offset();if(null!=timezone_db)timezone_array=timezone_db.split(":"),timezone_format=timezone_array[0],timezone_format_mins=timezone_array[1],timezone_minutes=".0","30"==timezone_format_mins&&(timezone_minutes=".5"),timezone_format=parseInt(timezone_format,10)+timezone_minutes,$("#timezone_picker").val(timezone_format);else if("none"!=current_timezone){var v=parseInt(current_timezone.substr(0,3)),m=parseInt(current_timezone.substr(4,2));$("#timezone_picker").val(0!=m?v+m/60:v+".0")}var d=new Date,sub=d.getDay();d.setDate(d.getDate()-sub);var startDate=new Date(d);d.setDate(d.getDate()+6);var endDate=new Date(d),copyDate=startDate;$("#CurrentPage").text(getDateRepresentation(startDate)+" - "+getDateRepresentation(endDate)),getWeeklyTimeslots(startDate),showAppointmentData(startDate),$("#copy_week").live("click",function(){$("#paste_week").css("display","block"),copyDate=startDate.toISOString().split("T")[0],console.log(copyDate)}),$("#paste_week").live("click",function(){var e=startDate.toISOString().split("T")[0];e!=copyDate&&endDate>=d?$.get("createDoctorTimeslot.php?copy="+copyDate+"&paste="+e,function(){getWeeklyTimeslots(startDate),showAppointmentData(startDate)}):alert(d>endDate?"You cannot paste a week into the past.":"Please choose another week to paste the copied week into.")}),$("#clear_week").live("click",function(){var e=confirm("Are you sure you want to delete this whole week?");e&&$.get("deleteDoctorAvailability.php?clear="+startDate.toISOString().split("T")[0],function(){displaynotification("Week Deleted"," "),getWeeklyTimeslots(startDate),showAppointmentData(startDate)})}),$("#timezone_picker").change(function(){console.log("Clicked"),getWeeklyTimeslots(startDate),showAppointmentData(startDate),email=doc_email,current_timezone=$("#timezone_picker").val(),url="get_timezone.php?timezone="+current_timezone+"&email="+email+"&type=doctor";
LanzaAjax(url)}),$("#next").live("click",function(){startDate.setDate(startDate.getDate()+7),endDate.setDate(endDate.getDate()+7),$("#CurrentPage").text(getDateRepresentation(startDate)+" - "+getDateRepresentation(endDate)),getWeeklyTimeslots(startDate),showAppointmentData(startDate),lastSelected="",selectedRow=-1,selectedColumn=-1,selectedTime=""}),$("#prev").live("click",function(){startDate.setDate(startDate.getDate()-7),endDate.setDate(endDate.getDate()-7),$("#CurrentPage").text(getDateRepresentation(startDate)+" - "+getDateRepresentation(endDate)),getWeeklyTimeslots(startDate),showAppointmentData(startDate),lastSelected="",selectedRow=-1,selectedColumn=-1,selectedTime=""});var TimeSlotData=new Array,lastSelected="",selectedRow=-1,selectedColumn=-1,selectedTime="";$(".timeCellIndicatorOff").live("mouseover",function(){if(1==$("#telemed_on").val()){var e=$(this).parent().parent().parent().parent().attr("id"),t=new Date(e),i=new Date;if(DateDiff.inDays(i,t)<0)return;$(this).addClass("timeCellIndicatorTempOn")}}),$(".timeCellIndicatorOff").live("mouseout",function(){if(1==$("#telemed_on").val()){var e=$(this).parent().parent().parent().parent().attr("id"),t=new Date(e),i=new Date;if(DateDiff.inDays(i,t)<0)return;$(this).hasClass("tempSelection")||$(this).removeClass("timeCellIndicatorTempOn")}}),$(".timeCellIndicatorOn").live("click",function(){if(1==$("#telemed_on").val()){var e=$(this).parent().parent().parent().parent().attr("id"),t=new Date(e),i=new Date;if(DateDiff.inDays(i,t)<0)return void displaynotification(" ","You cannot delete timeslots from the past");var a=$(this).parent().parent().attr("id"),r=getRowFromId(a);if(lastSelected==a){var n=selectedTime,o=getTime($(this).parent().parent().children(".timeLabel").text(),$(this).index()+1);o=add15min(o);var l=createTimeslot(n,o,r);return displaynotification("Timeslot Saved",getDateRepresentation(new Date(e))+" "+getTimeRepresentation(n)+" - "+getTimeRepresentation(o)),$(this).attr("class","timeCellIndicatorOn event_"+l),lastSelected="",selectedRow=-1,selectedColumn=-1,void(selectedTime="")}if(""!=lastSelected)return $("#"+lastSelected).children(".timeCellIndicator").children(".tempSelection").attr("class","timeCellIndicatorOff"),lastSelected="",selectedRow=-1,selectedColumn=-1,void(selectedTime="");var s=$(this).attr("class").split(/\s+/);$.each(s,function(e,t){if(t.indexOf("event")>-1){var i=parseInt(t.split("_")[1]),a=confirm("Are you sure you want to delete this event ? ");if(a){var n="deleteDoctorAvailability.php?eventID="+i;LanzaAjax(n),uncolorEventFromRow(r,i),displaynotification("Timeslot Deleted"," ")}}})}}),$(".timeCellIndicatorOff").live("click",function(){if(1==$("#telemed_on").val()){var e=$(this).parent().parent().parent().parent().attr("id"),t=new Date(e),i=new Date;if(DateDiff.inDays(i,t)<0)return void displaynotification(" ","You cannot create timeslots in the past");if(""!=lastSelected){var a=$(this).parent().parent().attr("id"),r=getRowFromId(a),n=getColumnFromId(a);if(r==selectedRow){if(selectedColumn>n){$(this).attr("class","timeCellIndicatorOn tempSelection");var o=getTime($(this).parent().parent().children(".timeLabel").text(),$(this).index()+1),l=add15min(selectedTime),s=createTimeslot(o,l,r);colorSlot(r,n,selectedColumn,s),displaynotification("Timeslot Saved",getDateRepresentation(new Date(e))+" "+getTimeRepresentation(o)+" "+getTimeRepresentation(l))}else if(n>selectedColumn){$(this).attr("class","timeCellIndicatorOn tempSelection");var o=selectedTime,l=getTime($(this).parent().parent().children(".timeLabel").text(),$(this).index()+1);l=add15min(l);var s=createTimeslot(o,l,r);colorSlot(r,selectedColumn,n,s),displaynotification("Timeslot Saved",getDateRepresentation(new Date(e))+" "+getTimeRepresentation(o)+" - "+getTimeRepresentation(l))}else{var o,l,c=getIndexFromTime(selectedTime),d=$(this).index()+1;$(this).attr("class","timeCellIndicatorOn tempSelection"),d>c?(o=selectedTime,l=getTime($(this).parent().parent().children(".timeLabel").text(),d),l=add15min(l)):(o=getTime($(this).parent().parent().children(".timeLabel").text(),d),l=add15min(selectedTime));var s=createTimeslot(o,l,r);colorSlot(r,selectedColumn,n,s),displaynotification("Timeslot Saved",getDateRepresentation(new Date(e))+" "+getTimeRepresentation(o)+" - "+getTimeRepresentation(l))}lastSelected="",selectedRow=-1,selectedColumn=-1,selectedTime=""}else $("#"+lastSelected).children(".timeCellIndicator").children(".tempSelection").attr("class","timeCellIndicatorOff"),lastSelected="",selectedRow=-1,selectedColumn=-1,selectedTime=""}else{$(this).attr("class","timeCellIndicatorOn tempSelection");var a=$(this).parent().parent().attr("id");lastSelected=a,selectedRow=getRowFromId(lastSelected),selectedColumn=getColumnFromId(lastSelected),selectedTime=getTime($(this).parent().parent().children(".timeLabel").text(),$(this).index()+1)}}});var DateDiff={inDays:function(e,t){var i=t.getTime(),a=e.getTime();return parseInt((i-a)/864e5)},inWeeks:function(e,t){var i=t.getTime(),a=e.getTime();return parseInt((i-a)/6048e5)},inMonths:function(e,t){var i=e.getFullYear(),a=t.getFullYear(),r=e.getMonth(),n=t.getMonth();return n+12*a-(r+12*i)},inYears:function(e,t){return t.getFullYear()-e.getFullYear()}};